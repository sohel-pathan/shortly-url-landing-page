const form=document.getElementById("form"),linkList=document.getElementById("links_list"),navbar=document.getElementById("navbar_links"),mobileMenu=document.getElementById("mobileMenu");mobileMenu.addEventListener("click",()=>{navbar.classList.toggle("active"),mobileMenu.querySelector(".fa-solid").classList.toggle("fa-xmark")}),navbar.addEventListener("click",e=>{let target=e.target;"navbar_links"!==target.id&&"A"!==target.tagName||(navbar.classList.remove("active"),mobileMenu.querySelector(".fa-solid").classList.toggle("fa-xmark"))});const linksArr=[],copyUrl=e=>{let target=e.target,shortLink=target.parentElement.querySelector(".shorten_link").textContent;navigator.clipboard.writeText(shortLink);let clicked=!1;if(!clicked)return target.textContent="Copied!",target.style.backgroundColor="#3b3054",clicked=!0,setTimeout(()=>{target.textContent="Copy",target.style.backgroundColor="#2acfcf",clicked=!1},800)};renderLinksList();const genShortUrl=async link=>{const res=await fetch(`https://api.shrtco.de/v2/shorten?url=${link}`),result=await res.json();return result};function isUrlvalid(url){if(!url)return!1;let pattern;return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))|localhost(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(url)}const submitLink=e=>{e.preventDefault();const originalLink=form.link.value;if(!isUrlvalid(originalLink))return form.link.value="",alert("enter valid link");genShortUrl(originalLink).then(result=>result.ok?(linksArr.unshift({originalLink:result.result.original_link,shortLink:result.result.short_link,id:result.result.code}),renderLinksList()):alert(result.error),err=>alert(err)),form.link.value=""};function renderLinksList(){linkList.innerHTML="",linksArr.length>5&&linksArr.pop(),linksArr.forEach(url=>{let linksListItem=document.createElement("div");linksListItem.classList.add("link_item");let ogLink=url.originalLink.replace(/http(s)?(:)?(\/\/)?|(\/\/)?(www\.)?/g,""),urlPara=document.createElement("div");urlPara.classList.add("original_link"),urlPara.innerHTML=`<p>${ogLink.length>35?ogLink.substring(35,0)+"...":ogLink}</p>`;let shortUrlPara=document.createElement("div");shortUrlPara.innerHTML=`<p> ${url.shortLink} </p>`,shortUrlPara.classList.add("shorten_link");let copyBtn=document.createElement("button");copyBtn.classList.add("copy_button"),copyBtn.classList.add("button"),copyBtn.textContent="Copy",copyBtn.onclick=copyUrl,linksListItem.appendChild(urlPara),linksListItem.appendChild(shortUrlPara),linksListItem.appendChild(copyBtn),linkList.appendChild(linksListItem)})}form.addEventListener("submit",submitLink(e));
