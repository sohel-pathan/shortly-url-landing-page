const form=document.getElementById("form"),shortUrl=document.getElementById("links_list"),navbar=document.getElementById("navbar_links"),bars=document.getElementById("bars");bars.addEventListener("click",()=>{navbar.classList.toggle("active"),bars.querySelector(".fa-solid").classList.toggle("fa-xmark")}),navbar.addEventListener("click",e=>{let target=e.target;"navbar_links"!==target.id&&"A"!==target.tagName||(navbar.classList.remove("active"),bars.querySelector(".fa-solid").classList.toggle("fa-xmark"))});const urls=[],copyUrl=e=>{let target=e.target,link=target.parentElement.querySelector(".shorten_link").textContent;navigator.clipboard.writeText(link);let clicked=!1;if(!clicked)return target.textContent="Copied!",target.style.backgroundColor="#3b3054",clicked=!0,setTimeout(()=>{target.textContent="Copy",target.style.backgroundColor="#2acfcf",clicked=!1},800)};renderUrls();const genShortUrl=async link=>{const res=await fetch(`https://api.shrtco.de/v2/shorten?url=${link}`),result=await res.json();return result};function isUrlvalid(url){if(!url)return!1;let pattern;return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))|localhost(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(url)}function renderUrls(){shortUrl.innerHTML="",urls.length>5&&urls.pop(),urls.forEach(url=>{let shortList=document.createElement("div");shortList.classList.add("link_item");let indexOfProtocol=url.originalLink.lastIndexOf("/",7),finalLInk=url.originalLink.substring(indexOfProtocol+1),indexOfSubdomain=finalLInk.lastIndexOf(".",3),urlPara=document.createElement("div");urlPara.classList.add("original_link"),urlPara.textContent=`${finalLInk.substring(indexOfSubdomain+1).substring(35,0)}`;let shortUrlPara=document.createElement("div");shortUrlPara.textContent=`${url.shortLink}`,shortUrlPara.classList.add("shorten_link");let copyBtn=document.createElement("button");copyBtn.classList.add("copy_button"),copyBtn.classList.add("button"),copyBtn.setAttribute("id",url.id),copyBtn.textContent="Copy",copyBtn.onclick=copyUrl,shortList.appendChild(urlPara),shortList.appendChild(shortUrlPara),shortList.appendChild(copyBtn),shortUrl.appendChild(shortList)})}form.addEventListener("submit",e=>{e.preventDefault();const originalLink=form.link.value;if(!isUrlvalid(originalLink))return form.link.value="",alert("enter vaid link");genShortUrl(originalLink).then(result=>result.ok?(urls.unshift({originalLink:result.result.original_link,shortLink:result.result.short_link,id:result.result.code}),renderUrls()):alert(result.error),err=>alert(err)),form.link.value=""});
